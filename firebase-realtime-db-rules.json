{
  "rules": {
    "schoolOnlineUsers": {
      "$schoolSlug": {
        ".read": true,
        // Only allow writes from server (Cloud Functions)
        // Client-side writes are blocked - only server can update online users
        // This prevents abuse and ensures all writes go through rate limiting and validation
        ".write": false
      }
    },
    "schoolHourlyUsers": {
      "$schoolSlug": {
        "$hourWindow": {
          ".read": true,
          // Only allow writes from server (Cloud Functions)
          // Client-side writes are blocked - only server can update hourly users
          // This prevents abuse and ensures all writes go through rate limiting and validation
          ".write": false
        }
      }
    },
    "schoolChats": {
      "$schoolSlug": {
        ".read": true,
        ".write": true,
        ".indexOn": "timestamp",
        "$messageId": {
          ".validate": "newData.hasChildren(['message', 'timestamp', 'userId']) && newData.child('message').isString() && newData.child('timestamp').isNumber()"
        }
      }
    },
    "schoolStats": {
      "$schoolSlug": {
        ".read": true,
        // Only allow writes from server (Cloud Functions)
        // Client-side writes are blocked - only server can update stats
        ".write": false
      }
    }
  }
}
